<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端部署方案 | Scatter Site</title>
    <meta name="description" content="self write">
    <link rel="stylesheet" href="/assets/style.5c810bdd.css">
    <link rel="modulepreload" href="/assets/app.19080868.js">
    <link rel="modulepreload" href="/assets/devops_frontend_前端项目部署方案.md.07dfc5e2.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-c6a644e1><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-c6a644e1 data-v-a50780ff><div class="VPNavBar has-sidebar" data-v-a50780ff data-v-6f1d18b5><div class="container" data-v-6f1d18b5><div class="VPNavBarTitle has-sidebar" data-v-6f1d18b5 data-v-d5925166><a class="title" href="/" data-v-d5925166><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.jpeg" alt data-v-b7ac6bd3><!--]--><!--[-->scatter<!--]--><!--[--><!--]--></a></div><div class="content" data-v-6f1d18b5><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6f1d18b5 data-v-f83db6ba><span id="main-nav-aria-label" class="visually-hidden" data-v-f83db6ba>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->首页<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> Projects <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/project/mr-notice/auto-deploy.html" data-v-e8e0fb1d data-v-3c355974><!--[-->soft-work<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/project/50projects50days/scrollAnimation.html" data-v-e8e0fb1d data-v-3c355974><!--[-->50projects50days<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/project/typescript-study/home.html" data-v-e8e0fb1d data-v-3c355974><!--[-->Typescript study<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/project/others/%E7%94%9F%E6%88%90%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E8%AE%B0%E5%BD%95%E5%B9%B6%E5%8F%91%E5%B8%83npm%E5%8C%85.html" data-v-e8e0fb1d data-v-3c355974><!--[-->其他项目相关<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> Devops <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/devops/frontend/eslint%E5%92%8Cprettier%E9%85%8D%E7%BD%AE.html" data-v-e8e0fb1d data-v-3c355974><!--[-->前端配置<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/devops/others/express%E4%B8%AD%E9%85%8D%E7%BD%AElog4js.html" data-v-e8e0fb1d data-v-3c355974><!--[-->其他配置相关<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> Javascript <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/js/designPatterns/index.html" data-v-e8e0fb1d data-v-3c355974><!--[-->设计模式<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->About Me<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6f1d18b5 data-v-a3e7452b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-a3e7452b data-v-481098f9 data-v-eba7420e><span class="check" data-v-eba7420e><span class="icon" data-v-eba7420e><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-481098f9><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-481098f9><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6f1d18b5 data-v-738bef5a data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/scattter" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6f1d18b5 data-v-e4361c82 data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6ffb57d3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6ffb57d3><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><!----><!--[--><!--[--><!----><div class="group" data-v-e4361c82><div class="item appearance" data-v-e4361c82><p class="label" data-v-e4361c82>Appearance</p><div class="appearance-action" data-v-e4361c82><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-e4361c82 data-v-481098f9 data-v-eba7420e><span class="check" data-v-eba7420e><span class="icon" data-v-eba7420e><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-481098f9><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-481098f9><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-e4361c82><div class="item social-links" data-v-e4361c82><div class="VPSocialLinks social-links-list" data-v-e4361c82 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/scattter" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6f1d18b5 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-c6a644e1 data-v-b6162a8b><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-b6162a8b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-b6162a8b><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-b6162a8b>Menu</span></button><a class="top-link" href="#" data-v-b6162a8b> Return to top </a></div><aside class="VPSidebar" data-v-c6a644e1 data-v-0f9e7c6e><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-0f9e7c6e><span class="visually-hidden" id="sidebar-aria-label" data-v-0f9e7c6e> Sidebar Navigation </span><!--[--><div class="group" data-v-0f9e7c6e><section class="VPSidebarGroup collapsible" data-v-0f9e7c6e data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>前端配置</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/devops/frontend/eslint%E5%92%8Cprettier%E9%85%8D%E7%BD%AE.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>eslint和prettier配置</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/devops/frontend/arco-design%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>arco-design简单使用记录</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/devops/frontend/%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>前端项目部署方案</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-0f9e7c6e><section class="VPSidebarGroup collapsible" data-v-0f9e7c6e data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>其他配置相关</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/devops/others/express%E4%B8%AD%E9%85%8D%E7%BD%AElog4js.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>express中配置log4js</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/devops/others/%E7%89%A9%E7%90%86%E6%9C%BA%E5%AE%89%E8%A3%85Linux%E5%90%8C%E6%97%B6%E5%AE%9E%E7%8E%B0%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>物理机安装Linux同时实现内网穿透</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/devops/others/Centos%E5%88%86%E5%8C%BA%E5%90%88%E5%B9%B6.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Centos分区合并</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/devops/others/Centos%E6%8C%82%E8%BD%BD%E7%A1%AC%E7%9B%98.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Centos挂载硬盘</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/devops/others/Github%E5%B8%B8%E7%94%A8api.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Github常用api</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-c6a644e1 data-v-d981fe29><div class="VPDoc has-sidebar has-aside" data-v-d981fe29 data-v-cfb513e0><div class="container" data-v-cfb513e0><div class="aside" data-v-cfb513e0><div class="aside-curtain" data-v-cfb513e0></div><div class="aside-container" data-v-cfb513e0><div class="aside-content" data-v-cfb513e0><div class="VPDocAside" data-v-cfb513e0 data-v-afc4c1a1><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-afc4c1a1 data-v-2865c0b0><div class="content" data-v-2865c0b0><div class="outline-marker" data-v-2865c0b0></div><div class="outline-title" data-v-2865c0b0>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-2865c0b0><span class="visually-hidden" id="doc-outline-aria-label" data-v-2865c0b0> Table of Contents for current page </span><ul class="root" data-v-2865c0b0 data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-afc4c1a1></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-cfb513e0><div class="content-container" data-v-cfb513e0><!--[--><!--]--><main class="main" data-v-cfb513e0><div style="position:relative;" class="vp-doc _devops_frontend_%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88" data-v-cfb513e0><div><h1 id="前端部署方案" tabindex="-1">前端部署方案 <a class="header-anchor" href="#前端部署方案" aria-hidden="true">#</a></h1><h2 id="一-触发方式" tabindex="-1">一. 触发方式 <a class="header-anchor" href="#一-触发方式" aria-hidden="true">#</a></h2><h3 id="_1-1-自动触发" tabindex="-1">1.1 自动触发 <a class="header-anchor" href="#_1-1-自动触发" aria-hidden="true">#</a></h3><p>使用<code>Jenkins/Gitlab runner</code> 等仓库监控工具去设置触发条件, 触发后执行开发自己设置的相应脚本, 如下面是我之前设置的一个gitlab脚本, 该脚本只对 <code>feature/zk</code> 分支生效, 即如果该分支有合入或者推送就会触发下面的命令, 替换Nginx的静态资源</p><blockquote><p>后面会补充gitlab runner的相关部署经历</p></blockquote><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">image: node:14.7.0</span></span>
<span class="line"><span style="color:#A6ACCD;">cache:</span></span>
<span class="line"><span style="color:#A6ACCD;">  key: ${CI_BUILD_REF_NAME}</span></span>
<span class="line"><span style="color:#A6ACCD;">  paths:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - node_modules/  #缓存node_modules</span></span>
<span class="line"><span style="color:#A6ACCD;">stages:</span></span>
<span class="line"><span style="color:#A6ACCD;">  #- test</span></span>
<span class="line"><span style="color:#A6ACCD;">  - deploy</span></span>
<span class="line"><span style="color:#A6ACCD;">MES-deploy:</span></span>
<span class="line"><span style="color:#A6ACCD;">  stage: deploy</span></span>
<span class="line"><span style="color:#A6ACCD;">  script:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - echo &#39;***************************&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    - cd ./product</span></span>
<span class="line"><span style="color:#A6ACCD;">    - npm install --registry=https://registry.npm.taobao.org</span></span>
<span class="line"><span style="color:#A6ACCD;">    - npm run build</span></span>
<span class="line"><span style="color:#A6ACCD;">    - rm -rf /usr/local/nginx/html/dist/product</span></span>
<span class="line"><span style="color:#A6ACCD;">    - cp -r /home/gitlab-runner/builds/hh4QSqNh/0/cdp/cdp-web/dist/product/ /usr/local/nginx/html/dist/product/</span></span>
<span class="line"><span style="color:#A6ACCD;">    - echo &#39;deploy success&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    - cd ..</span></span>
<span class="line"><span style="color:#A6ACCD;">    - echo &#39;***************************&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    - cd ./productGroup</span></span>
<span class="line"><span style="color:#A6ACCD;">    - npm install --registry=https://registry.npm.taobao.org</span></span>
<span class="line"><span style="color:#A6ACCD;">    - npm run build</span></span>
<span class="line"><span style="color:#A6ACCD;">    - ls</span></span>
<span class="line"><span style="color:#A6ACCD;">    - rm -rf /usr/local/nginx/html/dist/productGroup</span></span>
<span class="line"><span style="color:#A6ACCD;">    - cp -r /home/gitlab-runner/builds/hh4QSqNh/0/cdp/cdp-web/dist/productGroup/ /usr/local/nginx/html/dist/productGroup/</span></span>
<span class="line"><span style="color:#A6ACCD;">    - echo &#39;deploy success&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    - echo &#39;***************************&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  tags:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - v1</span></span>
<span class="line"><span style="color:#A6ACCD;">  only:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - feature/zk</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="_1-2-手动触发" tabindex="-1">1.2 手动触发 <a class="header-anchor" href="#_1-2-手动触发" aria-hidden="true">#</a></h3><p>这种方式有点原始</p><ol><li>一个是自己登陆服务器然后运行里面的构建脚本</li><li>开发在自己电脑上使用脚本去直连服务器, 然后跑一些脚本</li></ol><p>对于方式1, 就不说了. 如果是使用方式2, 那么需要直连服务器, 解决方案在下面</p><blockquote><p>服务器A连接服务器B, 并运行服务器B中的shell命令(不用输入密码) 将服务器A的 id_rsa.pub 复制到B服务器的 .ssh/authorized_keys 中, 如果B中没有该文件, 创建一个就可以 如 ssh root@10.253.xx.xx &quot;pwd&quot; , 即可 或者也可以使用下面的命令 <code>scp -r id_rsa.pub root@10.253.xx.xx:/root/.ssh/authorized_keys</code> 比如, 可以像下面这样去配置</p></blockquote><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">ssh root@10.253.xx.xx &quot;pwd&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">cd /xxx/project/</span></span>
<span class="line"><span style="color:#A6ACCD;">npm run build</span></span>
<span class="line"><span style="color:#A6ACCD;">cp dist /usr/share/nginx/html</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="二-部署方式" tabindex="-1">二. 部署方式 <a class="header-anchor" href="#二-部署方式" aria-hidden="true">#</a></h2><p>这里有两种部署方式</p><h3 id="_2-1-使用docker部署" tabindex="-1">2.1 使用Docker部署 <a class="header-anchor" href="#_2-1-使用docker部署" aria-hidden="true">#</a></h3><p>先提供相关文件(Dockerfile: 镜像打包, 这里使用了多阶段镜像打包, 即基于node生成的文件打包生成nginx镜像)</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">FROM node:16.13-alpine as node</span></span>
<span class="line"><span style="color:#A6ACCD;"># Install app dependencies</span></span>
<span class="line"><span style="color:#A6ACCD;"># A wildcard is used to ensure both package.json AND package-lock.json are copied</span></span>
<span class="line"><span style="color:#A6ACCD;"># where available (npm@5+)</span></span>
<span class="line"><span style="color:#A6ACCD;">COPY . .</span></span>
<span class="line"><span style="color:#A6ACCD;"># 安装依赖</span></span>
<span class="line"><span style="color:#A6ACCD;">RUN yarn install</span></span>
<span class="line"><span style="color:#A6ACCD;"># 打包</span></span>
<span class="line"><span style="color:#A6ACCD;">RUN yarn build</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">FROM nginx:latest</span></span>
<span class="line"><span style="color:#A6ACCD;"># 将上一步打包后的文件copy到nginx里面</span></span>
<span class="line"><span style="color:#A6ACCD;">COPY --from=node dist /usr/share/nginx/html</span></span>
<span class="line"><span style="color:#A6ACCD;">EXPOSE 80</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>镜像可以选择在服务器上打包, 然后直接重启或者在本地或者另一台服务器上打包, 再上传部署</p><ul><li>服务器上打包</li></ul><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">// example: 之前运行的容器是web</span></span>
<span class="line"><span style="color:#A6ACCD;">// 基于Dockerfile打包镜像</span></span>
<span class="line"><span style="color:#A6ACCD;">docker build -t web-img .</span></span>
<span class="line"><span style="color:#A6ACCD;"># 由于经常重复打包, 所以使用下面的命令删除无用的镜像</span></span>
<span class="line"><span style="color:#A6ACCD;">docker rmi $(docker images -f &quot;dangling=true&quot; -q)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">docker rm -f web</span></span>
<span class="line"><span style="color:#A6ACCD;">// 将nginx的配置文件挂载出来</span></span>
<span class="line"><span style="color:#A6ACCD;">docker run -d -it -p 80:80 -v /root/nginx/conf:/etc/nginx/conf.d --name web web-img /bin/bash</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>本地其他服务器打包镜像</li></ul><p>这种情况需要把打包的镜像上传到私库, 然后部署服务器再去拉取最新镜像重新部署. 听起来又要上传又要去重新拉取很麻烦, 但是这里可以使用一个镜像 <code>watchtower</code> 去帮助我们自动检测镜像是否变化, 是否需要重新部署, 具体如下Dokcerfile文件类似, 主要是打包上传脚本</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">#!/bin/bash</span></span>
<span class="line"><span style="color:#A6ACCD;"># 本地build镜像(指定dockerfile文件)</span></span>
<span class="line"><span style="color:#A6ACCD;">docker build -t vite . --no-cache</span></span>
<span class="line"><span style="color:#A6ACCD;"># 本地打tag</span></span>
<span class="line"><span style="color:#A6ACCD;">docker tag vite 10.253.xx.xx:5000/vite:latest</span></span>
<span class="line"><span style="color:#A6ACCD;"># 删除无用的镜像</span></span>
<span class="line"><span style="color:#A6ACCD;"># 由于经常重复打包, 所以使用下面的命令删除无用的镜像</span></span>
<span class="line"><span style="color:#A6ACCD;">docker rmi $(docker images -f &quot;dangling=true&quot; -q)</span></span>
<span class="line"><span style="color:#A6ACCD;"># 推送到私有仓库, 私有仓库</span></span>
<span class="line"><span style="color:#A6ACCD;">docker push 10.253.xx.xx:5000/vite:latest</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_2-2-普通部署" tabindex="-1">2.2 普通部署 <a class="header-anchor" href="#_2-2-普通部署" aria-hidden="true">#</a></h3><p>普通部署没什么好说的, 打包好后替换nginx html里面的静态资源即可, 使用一些简单的cp, rm命令</p><h2 id="三-补充" tabindex="-1">三. 补充 <a class="header-anchor" href="#三-补充" aria-hidden="true">#</a></h2><h3 id="_3-1-gitlab-runner" tabindex="-1">3.1 Gitlab runner <a class="header-anchor" href="#_3-1-gitlab-runner" aria-hidden="true">#</a></h3><p>相关配置可以直接搜索gitlab官网, 下面是一些之前配置普通版踩过的坑, Docker版的后面我再补充</p><ul><li><p>新建一个gitlab runner用户, 这里最好最好新建为root, 否则后面会有很多麻烦的权限问题, 导致CI/CD不能拉去代码</p><p><code>gitlab-runner install --working-directory /home/gitlab-runner --user root</code></p></li><li><p>证书问题</p><p>由于一些gitlab使用https证书, 导致我们注册gtilab的时候会在中间报错<code>X 509...</code> 这种</p></li></ul><p>解决方案就是将gitlab的证书注册到服务器上, 证书放在 <code>/etc/pki/ca-trust/source/anchors/</code> 文件夹里面, 然后更新证书</p><p>或者在注册gitlab runner的时候使用</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">xxx register --tls-ca-file xxxx  </span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>指定证书</p><ul><li><p>gitlab runner拉取代码报错</p><p>原因是gitlab runner连接的时候也需要有自己的ssh密钥 它走的不是服务器的ssh key</p></li></ul><p>我们需要先在/home/gitlab-runner目录下生成gitlab runner自己的ssh-key, 然后将这个key复制到目录服务器的 <code>/root/.ssh/authorized_keys</code> 文件中, 同时, 我们还需要在gitlab-runner服务器上使用gitlab-runner用户去ssh连接下, 输入确认, 然后CI才能正常访问, 如下所示:</p><p><img src="https://cdn.jsdelivr.net/gh/scattter/blogweb/images/image2.png" alt="image2"></p><p>或者可以尝试在runner的配置中添加下面的</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">environment = [&quot;GIT_SSL_NO_VERIFY=true&quot;]</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>配置完类似于下面这样</p><p><img src="https://cdn.jsdelivr.net/gh/scattter/blogweb/images/image1.png" alt="image1"></p><h3 id="_3-2-私有仓库创建和watchtower运行的命令" tabindex="-1">3.2 私有仓库创建和<code>watchtower</code>运行的命令 <a class="header-anchor" href="#_3-2-私有仓库创建和watchtower运行的命令" aria-hidden="true">#</a></h3><ul><li>私有仓库</li></ul><p>私有仓库相关知识链接: <a href="https://yeasy.gitbook.io/docker_practice/repository/registry" target="_blank" rel="noreferrer">https://yeasy</a> <a href="https://yeasy.gitbook.io/docker_practice/repository/registry" target="_blank" rel="noreferrer">.gitbook.io/docker_practice/repository/registry</a></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"># 搭建私有仓库 </span></span>
<span class="line"><span style="color:#A6ACCD;">$ docker run -d -p 5000:5000 --restart=always --name registry registry</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>本地/服务器想要将镜像推送到私有仓库, 有时还需要在本地配置私有仓库的地址, 否则docker不允许你通过非HTTPS的方式推送, 如下</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">registry-mirror</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://hub-mirror.c.163.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://mirror.baidubce.com</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">insecure-registries</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">10.253.xx.xx:5000</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>watchtower</li></ul><p>watchtower相关中文网站链接: <a href="https://p3terx.com/archives/docker-watchtower.html" target="_blank" rel="noreferrer">https://p3terx.com/archives/docker-watchtower.html</a></p><p><code>watchtower </code> 支持自定义监测容器对象, 但是有一点, 其目前只支持定时监测容器变化, 不能像Jenkins这种实时触发</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">docker run -d \</span></span>
<span class="line"><span style="color:#A6ACCD;">    --name watchtower \</span></span>
<span class="line"><span style="color:#A6ACCD;">    --restart unless-stopped \</span></span>
<span class="line"><span style="color:#A6ACCD;">    -v /var/run/docker.sock:/var/run/docker.sock \</span></span>
<span class="line"><span style="color:#A6ACCD;">    containrrr/watchtower -c \</span></span>
<span class="line"><span style="color:#A6ACCD;">    &lt;容器名字&gt; --interval 3600</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;"># 或者</span></span>
<span class="line"><span style="color:#A6ACCD;"> docker run -d --name watchtower --restart unless-stopped</span></span>
<span class="line"><span style="color:#A6ACCD;"> -v /var/run/docker.sock:/var/run/docker.sock </span></span>
<span class="line"><span style="color:#A6ACCD;"> containrrr/watchtower -c </span></span>
<span class="line"><span style="color:#A6ACCD;">$(cat ~/zk/.watchtower.list) </span></span>
<span class="line"><span style="color:#A6ACCD;">--interval 3600</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_3-3-docker部署" tabindex="-1">3.3 Docker部署 <a class="header-anchor" href="#_3-3-docker部署" aria-hidden="true">#</a></h3><p>Nginx的容器部署命令一般为</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"># 后台 交互 暴漏端口 挂载目录 名字 镜像名 交互shell</span></span>
<span class="line"><span style="color:#A6ACCD;">docker run -d -it -p 80:80 -v /root/nginx/conf:/etc/nginx/conf.d --name nginx /bin/bash</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面这种挂载如果conf里面没有文件, 那么也会把nginx镜像里面相对文件夹里面本来存在的文件给冲掉.</p><p>这里可以使用单个容器部署, 也可以使用docker-compose去部署, compose是配置型的文件, 所以会简单一些</p><h2 id="四-推荐方案" tabindex="-1">四. 推荐方案 <a class="header-anchor" href="#四-推荐方案" aria-hidden="true">#</a></h2><blockquote><p>简单的才是最好用的!此处的示例是基于自搭建的gitlab仓库实现的，示例基于下面的文章调试完成</p><p><a href="https://juejin.cn/post/6967972435064782879" target="_blank" rel="noreferrer">https://juejin.cn/post/6967972435064782879</a></p><p><a href="https://juejin.cn/post/7074780794459258917#heading-9" target="_blank" rel="noreferrer">https://juejin.cn/post/7074780794459258917#heading-9</a></p></blockquote><p>Gitlab runner(Docker) + Nginx(Docker)部署仓库地址: <a href="http://124.221.123.79:8084/" target="_blank" rel="noreferrer">http://124.221.123.79:8084/</a></p><h3 id="_4-1-搭建自己的gitlab仓库" tabindex="-1">4.1 搭建自己的gitlab仓库 <a class="header-anchor" href="#_4-1-搭建自己的gitlab仓库" aria-hidden="true">#</a></h3><p>因为仓库搭建起来很占内存，所以此处服务器最好是4G内存+</p><p>此处搭建使用docker中文版, docker compose运行</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">version: &#39;3&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">services:</span></span>
<span class="line"><span style="color:#A6ACCD;">   web:</span></span>
<span class="line"><span style="color:#A6ACCD;">     image: &#39;twang2218/gitlab-ce-zh&#39;   #gitlab镜像</span></span>
<span class="line"><span style="color:#A6ACCD;">     restart: always</span></span>
<span class="line"><span style="color:#A6ACCD;">     privileged: true  #权限</span></span>
<span class="line"><span style="color:#A6ACCD;">     hostname: &#39;&#39;       #主机名, 即虚拟机的IP, 这里可以是纯IP</span></span>
<span class="line"><span style="color:#A6ACCD;">     environment:</span></span>
<span class="line"><span style="color:#A6ACCD;">        TZ: &#39;Asia/Shanghai&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">        GITLAB_OMNIBUS_CONFIG: |</span></span>
<span class="line"><span style="color:#A6ACCD;">            external_url &#39;&#39; #主机名,即虚拟机的IP, 这里需要添加http前缀</span></span>
<span class="line"><span style="color:#A6ACCD;">            gitlab_rails[&#39;gitlab_shell_ssh_port&#39;] = 2222</span></span>
<span class="line"><span style="color:#A6ACCD;">            nginx[&#39;listen_port&#39;] = 8084</span></span>
<span class="line"><span style="color:#A6ACCD;">     ports:</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &#39;8084:8084&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &#39;8443:443&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &#39;2222:22&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">     volumes:</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &#39;./config:/etc/gitlab&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &#39;./logs:/var/log/gitlab&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &#39;./data:/var/opt/gitlab&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>配置解析</p><ul><li>external_url: 该参数是指定外部访问仓库的地址</li><li>gitlab_shell_ssh_port: ssh拉取代码的端口</li><li>nginx[&#39;listen_port&#39;]: nginx监听端口, 不设置的话就是external_url: 80或者443</li></ul><p>更多镜像配置可以参考: <a href="https://docs.gitlab.com/ee/administration/environment_variables.html" target="_blank" rel="noreferrer">https://docs.gitlab.com/ee/administration/environment_variables.html</a></p><h3 id="_4-2-配置gitlab-runner" tabindex="-1">4.2 配置Gitlab runner <a class="header-anchor" href="#_4-2-配置gitlab-runner" aria-hidden="true">#</a></h3><ul><li>启动容器</li></ul><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">docker run -d --name gitlab-runner --restart always</span></span>
<span class="line"><span style="color:#A6ACCD;">-v /home/gitlab-runner/config:/etc/gitlab-runner </span></span>
<span class="line"><span style="color:#A6ACCD;">-v /var/run/docker.sock:/var/run/docker.sock </span></span>
<span class="line"><span style="color:#A6ACCD;">gitlab/gitlab-runner:latest</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>映射<code>/var/run/docker.sock</code>这个文件是为了让容器可以通过<code>/var/run/docker.sock</code>与<code>Docker</code>守护进程通信，管理其他<code>Docker</code>容器 <code>-v /home/gitlab-runner/config:/etc/gitlab-runner</code>是将runner的配置文件映射到宿主机<code>/home/gitlab-runner/config</code>方便调整和查看配置</p><ul><li>注册runner</li></ul><p>可以进入容器进行注册, 也可以在外面进行注册, 这里可以使用 <code>gtilab-runner register</code> 进行交互式注册, 按照上面提示填写信息(信息可以在下图所示位置找到)即可</p><p><img src="https://cdn.jsdelivr.net/gh/scattter/blogweb/images/image.png" alt="image"></p><p>其中exector可以选docker. 注册完毕后我们可以在宿主机的<code>/home/gitlab-runner/config</code> 文件夹里面看见runner的配置信息, 如下所示</p><p><img src="https://cdn.jsdelivr.net/gh/scattter/blogweb/images/image3.png" alt="image3"></p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">concurrent = 1</span></span>
<span class="line"><span style="color:#A6ACCD;">check_interval = 0</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">[session_server]</span></span>
<span class="line"><span style="color:#A6ACCD;">  session_timeout = 1800</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">[[runners]]</span></span>
<span class="line"><span style="color:#A6ACCD;">  name = &quot;first-register-runner&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  url = &quot;http://xxx:8084/&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  token = &quot;xxx&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  executor = &quot;docker&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  clone_url = &quot;http://xxx:8084/&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  [runners.custom_build_dir]</span></span>
<span class="line"><span style="color:#A6ACCD;">  [runners.cache]</span></span>
<span class="line"><span style="color:#A6ACCD;">    [runners.cache.s3]</span></span>
<span class="line"><span style="color:#A6ACCD;">    [runners.cache.gcs]</span></span>
<span class="line"><span style="color:#A6ACCD;">    [runners.cache.azure]</span></span>
<span class="line"><span style="color:#A6ACCD;">  [runners.docker]</span></span>
<span class="line"><span style="color:#A6ACCD;">    tls_verify = false</span></span>
<span class="line"><span style="color:#A6ACCD;">    image = &quot;alpine:latest&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    privileged = false</span></span>
<span class="line"><span style="color:#A6ACCD;">    disable_entrypoint_overwrite = false</span></span>
<span class="line"><span style="color:#A6ACCD;">    oom_kill_disable = false</span></span>
<span class="line"><span style="color:#A6ACCD;">    disable_cache = false</span></span>
<span class="line"><span style="color:#A6ACCD;">    volumes = [&quot;/cache&quot;,&quot;/usr/bin/docker:/usr/bin/docker&quot;,&quot;/var/run/docker.sock:/var/run/docker.sock&quot;]</span></span>
<span class="line"><span style="color:#A6ACCD;">    shm_size = 0</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>后续有修改也可以直接在这里进行修改, 大部分配置修改不用手动重启runner 容器</p><p><strong>注意:</strong></p><ul><li>由于上面我们配置了nginx监听端口, 而runner执行的时候默认是从80等默认端口获取仓库文件的, 所以我们要在上面runner配置config.toml中增加一个属性: <code>clone_url</code>, 其值就是主机地址和nginx监听的端口</li><li>volumes里面添加docker的一些配置, 这样就可以在runner的docker里面创建基于宿主机的新docker(nginx)</li></ul><h3 id="_4-3-创建-gitlab-ci-yml文件" tabindex="-1">4.3 创建.gitlab-ci.yml文件 <a class="header-anchor" href="#_4-3-创建-gitlab-ci-yml文件" aria-hidden="true">#</a></h3><blockquote><p>如果是使用https, 那么需要寻找自签证书 <a href="https://docs.gitlab.com/runner/configuration/tls-self-signed.html#supported-options-for-self-signed-certificates-targeting-the-gitlab-server" target="_blank" rel="noreferrer">https://docs.gitlab.com/runner/configuration/tls-self-signed.html#supported-options-for-self-signed-certificates-targeting-the-gitlab-server</a> 其他的一些runner配置可以去gitlab上搜索一下, 我之前配置公司的runner失败了, 找不到完整证书 ci配置文件</p></blockquote><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">image: node:alpine</span></span>
<span class="line"><span style="color:#A6ACCD;">stages: # 分段</span></span>
<span class="line"><span style="color:#A6ACCD;">  - install</span></span>
<span class="line"><span style="color:#A6ACCD;">  - build</span></span>
<span class="line"><span style="color:#A6ACCD;">  - deploy</span></span>
<span class="line"><span style="color:#A6ACCD;">cache: # 缓存</span></span>
<span class="line"><span style="color:#A6ACCD;">  paths:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - node_modules</span></span>
<span class="line"><span style="color:#A6ACCD;">job_install:</span></span>
<span class="line"><span style="color:#A6ACCD;">  tags:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - v2</span></span>
<span class="line"><span style="color:#A6ACCD;">  stage: install</span></span>
<span class="line"><span style="color:#A6ACCD;">  script:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - npm install</span></span>
<span class="line"><span style="color:#A6ACCD;">  only:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - master</span></span>
<span class="line"><span style="color:#A6ACCD;">job_build:</span></span>
<span class="line"><span style="color:#A6ACCD;">  tags:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - v2</span></span>
<span class="line"><span style="color:#A6ACCD;">  stage: build</span></span>
<span class="line"><span style="color:#A6ACCD;">  script:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - npm run build</span></span>
<span class="line"><span style="color:#A6ACCD;">  artifacts:</span></span>
<span class="line"><span style="color:#A6ACCD;">    paths:</span></span>
<span class="line"><span style="color:#A6ACCD;">      - dist/</span></span>
<span class="line"><span style="color:#A6ACCD;">    expire_in: 3 mins</span></span>
<span class="line"><span style="color:#A6ACCD;">  only:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - master</span></span>
<span class="line"><span style="color:#A6ACCD;">job_deploy:</span></span>
<span class="line"><span style="color:#A6ACCD;">  tags:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - v2</span></span>
<span class="line"><span style="color:#A6ACCD;">  image: docker</span></span>
<span class="line"><span style="color:#A6ACCD;">  stage: deploy</span></span>
<span class="line"><span style="color:#A6ACCD;">  dependencies:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - job_build</span></span>
<span class="line"><span style="color:#A6ACCD;">  script:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - docker build . -t app-images</span></span>
<span class="line"><span style="color:#A6ACCD;">    - if [ $(docker ps -aq --filter name=app-container) ]; then docker rm -f app-container;fi</span></span>
<span class="line"><span style="color:#A6ACCD;">    - docker run -d -p 8082:80 --name app-container app-images</span></span>
<span class="line"><span style="color:#A6ACCD;">  only:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - master</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>dockerfile配置</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">FROM nginx:latest</span></span>
<span class="line"><span style="color:#A6ACCD;">COPY  ./dist /usr/share/nginx/html</span></span>
<span class="line"><span style="color:#A6ACCD;">EXPOSE 80</span></span>
<span class="line"><span style="color:#A6ACCD;"># nginx的官方镜像Dockerfile 已经指定 nginx -g &quot;daemon off;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">CMD [&quot;/usr/sbin/nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这里对原文的配置进行了一些改造, 去掉了无用的东西, 最后结果是配置了三个job, 分别为安装依赖和打包, 最后使用打包job生成的dist文件夹进行nginx docker构建与部署</p><h2 id="五-扩展-使用github-action" tabindex="-1">五. 扩展 - 使用Github action <a class="header-anchor" href="#五-扩展-使用github-action" aria-hidden="true">#</a></h2><p>仓库地址: <a href="https://github.com/scattter/template-react" target="_blank" rel="noreferrer">https://github.com/scattter/template-react</a></p><p>github给每个用户默认提供了服务器来跑流水线, 所以只需要通过github仓库的action仓库配置流水线即可</p><p>配置文件(不同项目可以设置不同的action)</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;"># This is a basic workflow to help you get started with Actions</span></span>
<span class="line"><span style="color:#A6ACCD;">name: Auto deploy</span></span>
<span class="line"><span style="color:#A6ACCD;"># Controls when the workflow will run</span></span>
<span class="line"><span style="color:#A6ACCD;">on:</span></span>
<span class="line"><span style="color:#A6ACCD;">  # Triggers the workflow on push or pull request events but only for the main branch</span></span>
<span class="line"><span style="color:#A6ACCD;">  push:</span></span>
<span class="line"><span style="color:#A6ACCD;">    branches: [ main, dev ]</span></span>
<span class="line"><span style="color:#A6ACCD;">  pull_request:</span></span>
<span class="line"><span style="color:#A6ACCD;">    branches: [ main, dev ]</span></span>
<span class="line"><span style="color:#A6ACCD;"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span></span>
<span class="line"><span style="color:#A6ACCD;">jobs:</span></span>
<span class="line"><span style="color:#A6ACCD;">  # This workflow contains a single job called &quot;build&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  build:</span></span>
<span class="line"><span style="color:#A6ACCD;">    # The type of runner that the job will run on</span></span>
<span class="line"><span style="color:#A6ACCD;">    runs-on: ubuntu-latest</span></span>
<span class="line"><span style="color:#A6ACCD;">    # Steps represent a sequence of tasks that will be executed as part of the job</span></span>
<span class="line"><span style="color:#A6ACCD;">    steps:</span></span>
<span class="line"><span style="color:#A6ACCD;">      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span></span>
<span class="line"><span style="color:#A6ACCD;">      - uses: actions/checkout@v3</span></span>
<span class="line"><span style="color:#A6ACCD;">      - name: Setup Node.js environment</span></span>
<span class="line"><span style="color:#A6ACCD;">        uses: actions/setup-node@v3.1.1</span></span>
<span class="line"><span style="color:#A6ACCD;">        with:</span></span>
<span class="line"><span style="color:#A6ACCD;">          node-version: &quot;14.X&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">      - name: install deps</span></span>
<span class="line"><span style="color:#A6ACCD;">        run: npm install</span></span>
<span class="line"><span style="color:#A6ACCD;">      - name: build app</span></span>
<span class="line"><span style="color:#A6ACCD;">        run: npm run build</span></span>
<span class="line"><span style="color:#A6ACCD;">      - name: deploy build file with scp</span></span>
<span class="line"><span style="color:#A6ACCD;">        uses: appleboy/scp-action@master</span></span>
<span class="line"><span style="color:#A6ACCD;">        with:</span></span>
<span class="line"><span style="color:#A6ACCD;">          host: ${{ secrets.REMOTE_HOST }}</span></span>
<span class="line"><span style="color:#A6ACCD;">          username: &#39;root&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">          password: ${{ secrets.REMOTE_PASSWORD }}</span></span>
<span class="line"><span style="color:#A6ACCD;">          port: 22</span></span>
<span class="line"><span style="color:#A6ACCD;">          source: &quot;dist/&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">          target: ${{ secrets.REMOTE_WORK_DIR }}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>上面的 <code>secrets.REMOTE_HOST</code> 等是用户自己配置在github仓库的, 这样就避免了私密信息的泄露 高阶的一些action配置(如docker部署)我暂时还没有去看</p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-cfb513e0 data-v-a54a85bd><div class="edit-info" data-v-a54a85bd><!----><div class="last-updated" data-v-a54a85bd><p class="VPLastUpdated" data-v-a54a85bd data-v-f7d51a9c>Last updated: <time datatime="2023-02-28T06:20:24.000Z" data-v-f7d51a9c></time></p></div></div><div class="prev-next" data-v-a54a85bd><div class="pager" data-v-a54a85bd><a class="pager-link prev" href="/devops/frontend/arco-design%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Previous page</span><span class="title" data-v-a54a85bd>arco-design简单使用记录</span></a></div><div class="has-prev pager" data-v-a54a85bd><a class="pager-link next" href="/devops/others/express%E4%B8%AD%E9%85%8D%E7%BD%AElog4js.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Next page</span><span class="title" data-v-a54a85bd>express中配置log4js</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"about.md\":\"de49f30c\",\"devops_frontend_arco-design简单使用记录.md\":\"5fa5ad0a\",\"devops_frontend_eslint和prettier配置.md\":\"e098d577\",\"devops_frontend_前端项目部署方案.md\":\"07dfc5e2\",\"devops_others_centos分区合并.md\":\"6aa25994\",\"devops_others_centos挂载硬盘.md\":\"62f67dba\",\"devops_others_express中配置log4js.md\":\"30bdf23a\",\"devops_others_github常用api.md\":\"28c02278\",\"devops_others_物理机安装linux同时实现内网穿透.md\":\"f6a2eeba\",\"index.md\":\"c40b37a0\",\"js_designpatterns_event_index.md\":\"dfbeade5\",\"js_designpatterns_index.md\":\"0aeb2e49\",\"js_designpatterns_module_index.md\":\"8257fd6b\",\"js_designpatterns_observe_index.md\":\"647c5edc\",\"js_designpatterns_prototype_index.md\":\"131082ef\",\"js_designpatterns_provide_index.md\":\"3c6952ac\",\"js_designpatterns_proxy_index.md\":\"a37c196a\",\"js_designpatterns_singleton_index.md\":\"99e51ac8\",\"js_vue_directives_tooltip_index.md\":\"aaa6b63d\",\"project_50projects50days_blurryloading.md\":\"c69e4b99\",\"project_50projects50days_calendar.md\":\"0d7b4e0a\",\"project_50projects50days_dragndrop.md\":\"b4649e08\",\"project_50projects50days_drawingboard.md\":\"5794a952\",\"project_50projects50days_rippleeffect.md\":\"cb732118\",\"project_50projects50days_morecontexttipanimation.md\":\"0070761b\",\"project_50projects50days_scrollanimation.md\":\"d00dca4c\",\"project_50projects50days_soundbtn.md\":\"9b28a940\",\"project_mr-notice_auto-deploy.md\":\"9f09d26d\",\"project_others_24小时直播推流.md\":\"14fb514a\",\"project_others_前端语音识别探索.md\":\"70475160\",\"project_others_家用摄像头本地存储和查看.md\":\"8f4d077e\",\"project_others_生成脚本执行记录并发布npm包.md\":\"5f32e381\",\"project_others_软路由探索.md\":\"c6103336\",\"project_typescript-study_01-函数间ts的交互使用.md\":\"090d7307\",\"project_typescript-study_02-ts实现函数重载.md\":\"ab6bc38f\",\"project_typescript-study_03-ts对简单的可选参数处理.md\":\"9ba0e215\",\"project_typescript-study_04-ts中元组的简单使用.md\":\"5f81e1f6\",\"project_typescript-study_05-ts中泛型的简单使用.md\":\"c36e05d0\",\"project_typescript-study_06-ts练习(reduce).md\":\"059d8bc9\",\"project_typescript-study_07-ts泛型中的keyof.md\":\"965db908\",\"project_typescript-study_08-ts中的utility-types.md\":\"ce3e8c9a\",\"project_typescript-study_09-ts中的readonly和不可改属性.md\":\"7e16c0f4\",\"project_typescript-study_10-ts中的enum和literal.md\":\"ccfac33e\",\"project_typescript-study_11-ts中class的implement与属性可见性.md\":\"f46b5994\",\"project_typescript-study_12-ts中的mapped types.md\":\"73877262\",\"project_typescript-study_13-ts中的readonly和static.md\":\"0d51c414\",\"project_typescript-study_14-ts中class的abstract.md\":\"a5051d33\",\"project_typescript-study_15-ts中实现mixin函数.md\":\"fb0693e0\",\"project_typescript-study_16-ts中的条件类型.md\":\"76ede167\",\"project_typescript-study_17-ts中的相关操作符.md\":\"22fe410c\",\"project_typescript-study_home.md\":\"1b28c001\"}")</script>
    <script type="module" async src="/assets/app.19080868.js"></script>
    
  </body>
</html>