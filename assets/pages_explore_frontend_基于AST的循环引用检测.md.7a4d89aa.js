import{_ as p,o as s,c as o,q as e,w as n,j as c,b as r,S as t,n as a,v as F}from"./app.3123c535.js";const g=JSON.parse('{"title":"\u57FA\u4E8EAST\u7684\u5FAA\u73AF\u5F15\u7528\u68C0\u6D4B","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u5165\u53E3\u6587\u4EF6","slug":"\u5165\u53E3\u6587\u4EF6","link":"#\u5165\u53E3\u6587\u4EF6","children":[]},{"level":2,"title":"AST\u89E3\u6790\u4E0E\u904D\u5386","slug":"ast\u89E3\u6790\u4E0E\u904D\u5386","link":"#ast\u89E3\u6790\u4E0E\u904D\u5386","children":[]},{"level":2,"title":"\u89E3\u6790\u7EDD\u5BF9\u5730\u5740","slug":"\u89E3\u6790\u7EDD\u5BF9\u5730\u5740","link":"#\u89E3\u6790\u7EDD\u5BF9\u5730\u5740","children":[]},{"level":2,"title":"\u9012\u5F52\u904D\u5386\u68C0\u6D4B","slug":"\u9012\u5F52\u904D\u5386\u68C0\u6D4B","link":"#\u9012\u5F52\u904D\u5386\u68C0\u6D4B","children":[]},{"level":2,"title":"\u6253\u5370\u5FAA\u73AF\u5F15\u7528\u4FE1\u606F","slug":"\u6253\u5370\u5FAA\u73AF\u5F15\u7528\u4FE1\u606F","link":"#\u6253\u5370\u5FAA\u73AF\u5F15\u7528\u4FE1\u606F","children":[]},{"level":2,"title":"\u603B\u7ED3","slug":"\u603B\u7ED3","link":"#\u603B\u7ED3","children":[]}],"relativePath":"pages/explore/frontend/\u57FA\u4E8EAST\u7684\u5FAA\u73AF\u5F15\u7528\u68C0\u6D4B.md","lastUpdated":1700992213000}'),y={name:"pages/explore/frontend/\u57FA\u4E8EAST\u7684\u5FAA\u73AF\u5F15\u7528\u68C0\u6D4B.md"},D=a('<h1 id="\u57FA\u4E8East\u7684\u5FAA\u73AF\u5F15\u7528\u68C0\u6D4B" tabindex="-1">\u57FA\u4E8EAST\u7684\u5FAA\u73AF\u5F15\u7528\u68C0\u6D4B <a class="header-anchor" href="#\u57FA\u4E8East\u7684\u5FAA\u73AF\u5F15\u7528\u68C0\u6D4B" aria-hidden="true">#</a></h1><blockquote><p>\u5FAA\u73AF\u5F15\u7528\u7684\u5B9A\u4E49:</p><p>\u5982\u679C\u5F53\u524D\u6709\u4E00\u4E2A\u6587\u4EF6<code>entry.js</code>, \u91CC\u9762\u5F15\u7528\u4E86\u6587\u4EF6<code>foo.js</code>, \u968F\u540E\u5728<code>foo.js</code> \u91CC\u9762\u53C8\u5F15\u7528\u4E86<code>entry.js</code> . \u8FD9\u5C31\u662F\u5FAA\u73AF\u5F15\u7528, \u5728<code>commonjs</code> \u548C <code>esmodule</code> \u4E2D\u6709\u4E0D\u540C\u7684\u6807\u7B7E, \u5176\u4E2D\u524D\u8005\u4E0D\u652F\u6301\u5FAA\u73AF\u5F15\u7528, \u540E\u8005\u652F\u6301\u4F46\u662F\u4E0D\u63A8\u8350(\u5177\u4F53\u5371\u5BB3\u89C1\u4E0B\u56FE).</p><p>\u5728\u7B80\u5355\u7684\u903B\u8F91\u4E0B\u4E00\u822C\u4E0D\u4F1A\u51FA\u73B0\u5FAA\u73AF\u5F15\u7528\u95EE\u9898, \u4F46\u662F\u5982\u679C\u9700\u6C42\u590D\u6742, \u5C42\u7EA7\u5D4C\u5957\u8FC7\u6DF1\u5C31\u5F88\u5BB9\u6613\u51FA\u73B0\u4E0D\u6613\u5BDF\u89C9\u7684\u5FAA\u73AF\u5F15\u7528.</p></blockquote><p>\u4E3A\u4E86\u66F4\u597D\u7684\u907F\u514D\u5FAA\u73AF\u5F15\u7528\u95EE\u9898\u7684\u51FA\u73B0, \u6211\u4EEC\u53EF\u4EE5\u501F\u52A9<code>AST</code> \u904D\u5386\u6765\u8FDB\u884C\u68C0\u6D4B. \u5176\u4E3B\u8981\u7684\u539F\u7406\u5C31\u662F\u627E\u5230\u4E00\u4E2A\u6587\u4EF6\u5165\u53E3, \u968F\u540E\u904D\u5386\u6BCF\u4E00\u4E2A\u5F15\u7528, \u751F\u6210\u5F15\u7528\u94FE, \u5982\u679C\u5F15\u7528\u94FE\u4E2D\u5B58\u5728\u5F53\u524D\u5730\u5740, \u5373\u89C6\u4E3A\u6709\u5FAA\u73AF\u5F15\u7528, \u68C0\u6D4B\u6210\u529F.</p><p><img src="https://cdn.jsdelivr.net/gh/scattter/blogweb/images/image-20231126174643039.png" alt="image-20231126174643039"></p><p>\u672C\u7BC7\u6587\u7AE0\u5185\u5FAA\u73AF\u68C0\u6D4B\u7684\u4E3B\u8981\u6D41\u7A0B\u56FE\u5982\u4E0B\u6240\u793A:</p>',5),i=a(`<h2 id="\u5165\u53E3\u6587\u4EF6" tabindex="-1">\u5165\u53E3\u6587\u4EF6 <a class="header-anchor" href="#\u5165\u53E3\u6587\u4EF6" aria-hidden="true">#</a></h2><p>\u8FD9\u91CC\u6839\u636E\u9879\u76EE\u7684\u4E0D\u540C\u6709\u4E0D\u540C\u7684\u7B5B\u9009\u65B9\u6CD5, \u4E0D\u8FC7\u90FD\u662F\u7528\u6B63\u5219\u8868\u8FBE\u5F0F\u7B49\u89C4\u5219\u53BB\u8FDB\u884C\u5BFB\u627E.</p><p>\u8FD9\u91CC\u53EF\u4EE5\u4F7F\u7528\u7B2C\u4E09\u65B9\u4F9D\u8D56\u6765\u8FDB\u884C\u7B80\u5355\u7684\u5165\u53E3\u8DEF\u5F84\u67E5\u627E</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// \u67E5\u627E\u5165\u53E3</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> files </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">await</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">glob</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">\`\${</span><span style="color:#A6ACCD;">workspace</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">/**/entry.js</span><span style="color:#89DDFF;">\`</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">ignore</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">**/node_modules/**</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="ast\u89E3\u6790\u4E0E\u904D\u5386" tabindex="-1">AST\u89E3\u6790\u4E0E\u904D\u5386 <a class="header-anchor" href="#ast\u89E3\u6790\u4E0E\u904D\u5386" aria-hidden="true">#</a></h2><p>\u8FD9\u91CC\u4E3B\u8981\u7528\u5230\u4E86<code>babel</code> \u7684\u63D2\u4EF6\u6765\u8FDB\u884C<code>AST</code> \u89E3\u6790, \u89E3\u6790\u51FA\u6765\u4E3A<code>Estree</code> \u89C4\u5219, \u8FD9\u91CC\u8FD8\u6709\u53E6\u4E00\u4E2A<code>Acorn</code> \u89C4\u5219, \u4E0D\u8FC7\u8FD9\u4E24\u4E2A\u90FD\u5DEE\u4E0D\u591A.</p><p>\u8FD9\u91CC\u89E3\u6790\u540E\u76F4\u63A5\u8FDB\u884C\u904D\u5386, \u4E3B\u8981\u662F\u5BF9<code>import specifiers from source</code> \u7C7B\u578B\u7684\u5F15\u7528\u8FDB\u884C\u5904\u7406, \u4FDD\u5B58\u5F15\u7528\u7684<code>module</code> \u4EE5\u53CA\u5177\u4F53\u7684\u884C\u6570\u4FE1\u606F, \u5F53\u7136\u4E5F\u6709\u9488\u5BF9\u5176\u4ED6\u5F15\u7528\u7684\u89C4\u5219\u5904\u7406, \u5982<code>CallExpression</code> \u9488\u5BF9<code>import(&#39;module&#39;)</code> \u548C <code>require(&#39;module&#39;)</code> ; <code>ExportAllDeclaration</code> \u9488\u5BF9 <code>export \\* from source</code></p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> parseFile </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">code</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">moduleNameSet</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Set</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u89E3\u6790\u6587\u4EF6</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ast</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">code</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    sourceType</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">module</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u904D\u5386\u6587\u4EF6, \u83B7\u53D6\u5F15\u7528\u540D\u548C\u884C\u6570\u4FE1\u606F</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">traverse</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ast</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    ImportDeclaration</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">moduleNameSet</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        moduleName</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">source</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        line</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">node</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">loc</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">start</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">line</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">??</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">moduleNameSet</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="\u89E3\u6790\u7EDD\u5BF9\u5730\u5740" tabindex="-1">\u89E3\u6790\u7EDD\u5BF9\u5730\u5740 <a class="header-anchor" href="#\u89E3\u6790\u7EDD\u5BF9\u5730\u5740" aria-hidden="true">#</a></h2><p>\u8FD9\u91CC\u6839\u636E\u9879\u76EE\u7684\u4E0D\u540C\u6709\u4E0D\u540C\u7684\u5904\u7406, \u5982\u679C\u4E0D\u60F3\u5904\u7406<code>nodejs</code> \u7C7B\u578B, \u90A3\u4E48\u53EF\u4EE5\u76F4\u63A5\u5FFD\u7565; \u5982\u679C\u9879\u76EE\u91CC\u9762\u914D\u7F6E\u4E86<code>Alias</code> , \u90A3\u4E48\u9700\u8981\u5904\u7406\u4E0B\u522B\u540D, \u4F7F\u7528\u771F\u5B9E\u5730\u5740\u8FDB\u884C\u66FF\u6362(\u8FD9\u91CC\u9700\u8981\u53BB\u8BFB\u53D6\u914D\u7F6E\u6587\u4EF6\u83B7\u53D6\u522B\u540D\u914D\u7F6E); \u5982\u679C\u662F\u76F8\u5BF9\u5F15\u7528, \u90A3\u4E48\u5C31\u5904\u7406\u4E0B\u76F8\u5BF9\u5F15\u7528\u5373\u53EF.</p><p>\u5728\u8FD9\u4E2A\u6587\u6863\u91CC\u9762\u5C31\u7B80\u5355\u7684\u5BF9\u76F8\u5BF9\u5F15\u7528\u5904\u7406\u4E0B</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u83B7\u53D6\u4F9D\u8D56\u7684\u7EDD\u5BF9\u5730\u5740</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">param</span><span style="color:#676E95;"> </span><span style="color:#A6ACCD;">moduleName</span><span style="color:#676E95;">: \u4F9D\u8D56(\u5982&#39;./xx.js&#39;)</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">param</span><span style="color:#676E95;"> </span><span style="color:#A6ACCD;">sourceFile</span><span style="color:#676E95;">: \u6E90\u6587\u4EF6(\u5982&#39;entry.js&#39;)</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">returns</span><span style="color:#676E95;"> </span><span style="color:#89DDFF;">{</span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">}</span><span style="color:#676E95;">: \u7EDD\u5BF9\u5730\u5740(\u5982&#39;/Users/xx/project-1/xx.js&#39;)</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> getOriginPath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">moduleName</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">sourceFile</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u76F8\u5BF9\u5F84\u8DEF\u6587\u4EF6</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dir</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dirname</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">sourceFile</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">moduleName</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">dir</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">moduleName</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="\u9012\u5F52\u904D\u5386\u68C0\u6D4B" tabindex="-1">\u9012\u5F52\u904D\u5386\u68C0\u6D4B <a class="header-anchor" href="#\u9012\u5F52\u904D\u5386\u68C0\u6D4B" aria-hidden="true">#</a></h2><p>\u5728\u4E0A\u8FF0\u5BF9\u5F15\u7528\u5730\u5740\u5904\u7406\u5B8C\u6BD5\u540E\u5C31\u53EF\u4EE5\u5BF9\u5176\u8FDB\u884C\u9012\u5F52\u68C0\u6D4B\u4E86.</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">/**</span></span>
<span class="line"><span style="color:#676E95;"> * \u9012\u5F52\u67E5\u627E\u5FAA\u73AF\u4F9D\u8D56</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">param</span><span style="color:#676E95;"> </span><span style="color:#A6ACCD;">file</span><span style="color:#676E95;">: \u5165\u53E3\u6587\u4EF6</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">param</span><span style="color:#676E95;"> </span><span style="color:#A6ACCD;">chain</span><span style="color:#676E95;">: \u4F9D\u8D56\u94FE(\u5305\u542B\u5F53\u524D\u6587\u4EF6)</span></span>
<span class="line"><span style="color:#676E95;"> * </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">returns</span><span style="color:#676E95;"> </span><span style="color:#89DDFF;">{</span><span style="color:#FFCB6B;">void</span><span style="color:#89DDFF;">}</span><span style="color:#676E95;">: \u5F53\u627E\u5230\u5FAA\u73AF\u4F9D\u8D56\u65F6, \u4F1A\u5C06\u4F9D\u8D56\u94FE\u5B58\u5165callerChain, \u9000\u51FA\u5FAA\u73AF</span></span>
<span class="line"><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> findCycleModule </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">chain</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">moduleName</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">line</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">file</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">pureChain</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">chain</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">item</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">item</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">moduleName</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">pureChain</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">includes</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">moduleName</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">callerChain</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">moduleName</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">chain</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">file</span><span style="color:#F07178;">])</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">callerChain</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">callerChain</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">has</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">moduleName</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u8FD9\u4E2A\u53D8\u91CF\u662F\u5904\u7406\u5B8C\u7684\u7EDD\u5BF9\u5F15\u7528\u5730\u5740</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">originPath</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Set</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u7701\u7565\u6389\u5176\u4ED6\u5904\u7406</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u9012\u5F52\u5230\u5F53\u524D\u6587\u4EF6\u5185\u90E8, \u67E5\u627E\u5FAA\u73AF\u4F9D\u8D56</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u9012\u5F52\u65F6\u521D\u59CB\u6587\u4EF6\u884C\u6570\u8981\u66F4\u6539\u4E3A\u5F53\u524Dmodule\u7684\u884C\u6570</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">cFile</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">of</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">originPath</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">findCycleModule</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">cFile</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">chain</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      moduleName</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">moduleName</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      line</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">cFile</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">line</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">])</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>\u53EF\u4EE5\u770B\u5230, \u9012\u5F52\u505C\u6B62\u7684\u6761\u4EF6\u5C31\u662F</p><ol><li>\u53D1\u73B0\u5F53\u524D\u5F15\u7528\u94FE\u4E0A\u5F15\u7528\u8FC7\u5F53\u524D\u5F15\u7528</li><li>\u5168\u5C40\u53D8\u91CF(\u4FDD\u5B58\u6240\u6709\u7684\u5FAA\u73AF\u5F15\u7528)\u5B58\u5728\u5F53\u524D\u68C0\u6D4B</li><li>\u5F53\u524D\u6587\u4EF6\u6CA1\u6709\u5F15\u7528\u5176\u4ED6\u6587\u4EF6\u4E86</li></ol><p>\u5F53\u904D\u5386\u7ED3\u675F\u540E, <code>callerChain</code> \u91CC\u9762\u5C31\u662F\u4FDD\u5B58\u7684\u6240\u6709\u5FAA\u73AF\u5F15\u7528\u4FE1\u606F</p><h2 id="\u6253\u5370\u5FAA\u73AF\u5F15\u7528\u4FE1\u606F" tabindex="-1">\u6253\u5370\u5FAA\u73AF\u5F15\u7528\u4FE1\u606F <a class="header-anchor" href="#\u6253\u5370\u5FAA\u73AF\u5F15\u7528\u4FE1\u606F" aria-hidden="true">#</a></h2><p>\u8FD9\u4E00\u90E8\u5206\u5C31\u6BD4\u8F83\u7B80\u5355\u4E86, \u6839\u636E\u81EA\u5DF1\u7684\u9700\u8981\u8FDB\u884C\u6570\u636E\u5904\u7406\u5373\u53EF</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// \u6253\u5370\u5FAA\u73AF\u4F9D\u8D56\u4FE1\u606F</span></span>
<span class="line"><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> (</span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> value</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">of</span><span style="color:#A6ACCD;"> callerChain) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">\u5FAA\u73AF\u4F9D\u8D56\u5B58\u5728\u4E8E\u6587\u4EF6: </span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">key</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">\u4F9D\u8D56\u94FE: </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">item</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">---&gt; </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">item</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">moduleName</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">: </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">item</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">line</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u63A7\u5236\u53F0\u5982\u4E0B\u6240\u793A</p><p><img src="https://cdn.jsdelivr.net/gh/scattter/blogweb/images/image-20231126173936912.png" alt="image-20231126173936912"></p><h2 id="\u603B\u7ED3" tabindex="-1">\u603B\u7ED3 <a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a></h2><p>\u5F53\u7136, \u5982\u679C\u628A\u8FD9\u4E2A\u529F\u80FD\u505A\u6210\u4E00\u4E2A<code>cli</code> \u7684\u8BDD\u80AF\u5B9A\u662F\u9700\u8981\u8003\u8651\u66F4\u591A\u7EC6\u8282\u7684, \u540C\u65F6\u4E5F\u9700\u8981\u5F15\u5165\u4E00\u4E9B\u65B0\u7684\u4F9D\u8D56\u8FDB\u884C\u547D\u4EE4\u884C\u7684\u4EA4\u4E92, \u8FD9\u4E00\u90E8\u5206\u53EF\u4EE5\u5728\u5B8C\u5584\u7684\u65F6\u5019\u8FDB\u884C\u6DFB\u52A0, \u4F7F\u5176\u80FD\u591F\u771F\u6B63\u843D\u5730.</p><p>\u6700\u540E, \u611F\u8C22\u7EC4\u5185\u540C\u4E8B, \u6B63\u662F\u7EC4\u5185\u5DE5\u5177\u7684\u6E90\u4EE3\u7801\u624D\u8BA9\u6211\u53C8\u4E86\u89E3\u5230\u4E0D\u5C11\u76F8\u5173\u77E5\u8BC6.</p>`,26);function A(C,d,b,m,u,E){const l=F("Mermaid");return s(),o("div",null,[D,(s(),e(t,null,{default:n(()=>[c(l,{id:"mermaid-23",graph:"flowchart%20LR%0A%09z%5B%22code(%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6)%22%5D%20--%3E%20%7Cbabel%20parse%7CAST%20--%3E%20%7Cbabel%20traverse%7CAST%E9%81%8D%E5%8E%86%20--%3E%20%E8%BF%94%E5%9B%9E%E5%BC%95%E7%94%A8%E5%90%8D%E5%92%8C%E8%A1%8C%E6%95%B0%E4%BF%A1%E6%81%AF%20--%3E%20a%5B%E8%A7%A3%E6%9E%90%E5%BC%95%E7%94%A8%E4%B8%BA%E7%BB%9D%E5%AF%B9%E5%9C%B0%E5%9D%80%5D%0A%09a%20--%3E%20b%5B%22%E5%88%9D%E5%A7%8B%E5%BC%95%E7%94%A8%E9%93%BE(%E7%A9%BA%E6%95%B0%E7%BB%84)%22%5D%20--%3E%20%E9%80%92%E5%BD%92%E9%81%8D%E5%8E%86%20--%3E%20c%7B%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%3CBr%3E%E9%87%8D%E5%A4%8D%E5%BC%95%E7%94%A8%7D%20--%3E%20%7C%E6%98%AF%7C%E9%80%80%E5%87%BA%E9%80%92%E5%BD%92%E5%B9%B6%E4%BF%9D%E6%8C%81%0A%09c%20--%3E%20%7C%E5%90%A6%7C%E7%BB%A7%E7%BB%AD%E9%80%92%E5%BD%92%0A"})]),fallback:n(()=>[r(" Loading... ")]),_:1})),i])}const _=p(y,[["render",A]]);export{g as __pageData,_ as default};
